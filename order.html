<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Pizza - Pizza Order</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100">
    <header class="bg-red-600 text-white py-4 shadow-md">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <h1 class="text-3xl font-semibold">Pizza Order</h1>
            <nav class="hidden md:block">
                <ul class="flex space-x-6">
                    <li><a href="index.html" class="hover:text-red-200 transition duration-300">Home</a></li>
                    <li><a href="menu.html" class="hover:text-red-200 transition duration-300">Menu</a></li>
                    <li><a href="reservation.html" class="hover:text-red-200 transition duration-300">Reservations</a></li>
                    <li><a href="order.html" class="hover:text-red-200 transition duration-300">Order</a></li>
                    <li><a href="contact.html" class="hover:text-red-200 transition duration-300">Contact</a></li>
                    <li><a href="account.html" class="hover:text-red-200 transition duration-300">Account</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section id="order" class="bg-white py-12">
        <div class="container mx-auto px-4">
            <h2 class="text-3xl font-semibold text-red-700 text-center mb-8">Order Your Pizza</h2>
            <div id="order-form-container" class="bg-gray-100 shadow-md rounded-lg p-8 max-w-md mx-auto">
                <form id="order-form" class="">
                    <div class="mb-4">
                        <label for="order-name" class="block text-gray-700 text-sm font-bold mb-2">Name:</label>
                        <input type="text" id="order-name" name="order-name" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <div id="order-name-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <div class="mb-4">
                        <label for="order-email" class="block text-gray-700 text-sm font-bold mb-2">Email:</label>
                        <input type="email" id="order-email" name="order-email" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <div id="order-email-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <div class="mb-4">
                        <label for="order-pizza" class="block text-gray-700 text-sm font-bold mb-2">Choose Your Pizza:</label>
                        <select id="order-pizza" name="order-pizza" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        </select>
                        <div id="order-pizza-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <div class="mb-4">
                        <label for="order-quantity" class="block text-gray-700 text-sm font-bold mb-2">Quantity:</label>
                        <input type="number" id="order-quantity" name="order-quantity" min="1" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                        <div id="order-quantity-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <div class="mb-4">
                        <label for="order-type" class="block text-gray-700 text-sm font-bold mb-2">Delivery or Pickup:</label>
                        <select id="order-type" name="order-type" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                            <option value="delivery">Delivery</option>
                            <option value="pickup">Pickup</option>
                        </select>
                        <div id="order-type-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <div class="mb-4" id="delivery-address-section" style="display: none;">
                        <label for="order-address" class="block text-gray-700 text-sm font-bold mb-2">Delivery Address:</label>
                        <input type="text" id="order-address" name="order-address" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
                        <div id="order-address-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <div class="mb-4">
                        <label for="payment-method" class="block text-gray-700 text-sm font-bold mb-2">Payment Method:</label>
                        <select id="payment-method" name="payment-method" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" required>
                            <option value="creditcard">Credit Card</option>
                            <option value="paypal">PayPal</option>
                            <option value="cash">Gcash</option>
                            <option value="cash">Cash on Delivery/Pickup</option>
                        </select>
                        <div id="payment-method-error" class="text-red-500 text-xs italic" style="display: none;"></div>
                    </div>
                    <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Place Order</button>
                    <div id="order-message" class="mt-4 text-center font-semibold"></div>
                </form>
            </div>
        </div>
    </section>

    <footer class="bg-gray-800 text-white py-4">
        <div class="container mx-auto px-4 text-center">
            <p>Â© 2024 Pizza Order. All rights reserved.</p>
        </div>
    </footer>

    <script>
        const pizzaMenu = [
            { name: "Margherita", price: 100},
            { name: "Pepperoni", price: 120},
            { name: "Vegetarian", price: 110},
            { name: "Hawaiian", price: 130},
            { name: "Meat Feast", price: 140},
            { name: "Four Cheese", price: 120},
        ];

        const orderPizzaSelect = document.getElementById("order-pizza");
        pizzaMenu.forEach(pizza => {
            const option = document.createElement("option");
            option.value = pizza.name;
            option.textContent = `${pizza.name} - ${pizza.price.toFixed(2)} PHP`;
            orderPizzaSelect.appendChild(option);
        });

        const orderForm = document.getElementById('order-form');
        const orderTypeSelect = document.getElementById('order-type');
        const deliveryAddressSection = document.getElementById('delivery-address-section');
        const orderAddressInput = document.getElementById('order-address');

        orderTypeSelect.addEventListener('change', () => {
            if (orderTypeSelect.value === 'delivery') {
                deliveryAddressSection.style.display = 'block';
                orderAddressInput.setAttribute('required', 'true');
            } else {
                deliveryAddressSection.style.display = 'none';
                orderAddressInput.removeAttribute('required');
                orderAddressInput.value = ''; // Clear address if switching to pickup
            }
        });

        orderForm.addEventListener('submit', (e) => {
            e.preventDefault();
            if (validateOrderForm()) {
                const formData = new FormData(orderForm);
                const data = {};
                formData.forEach((value, key) => {
                    data[key] = value;
                });

                const selectedPizza = pizzaMenu.find(pizza => pizza.name === data['order-pizza']);
                const totalPrice = selectedPizza.price * parseInt(data['order-quantity']);

                // Store order details in session storage to pass to success page
                sessionStorage.setItem('orderMessage', `Order placed for ${data['order-quantity']} x ${data['order-pizza']} (${data['order-type']}). Total: ${totalPrice.toFixed(2)} PHP. Payment method: ${data['payment-method']}.`);
                window.location.href = 'success.html'; // Redirect to success page
            }
        });

        function validateOrderForm() {
            const form = document.getElementById('order-form');
            const inputs = form.querySelectorAll('input, select');
            let valid = true;

            inputs.forEach(input => {
                const errorId = input.id + '-error';
                const errorElement = document.getElementById(errorId);

                if (input.hasAttribute('required') && !input.value.trim()) {
                    errorElement.textContent = 'This field is required';
                    errorElement.style.display = 'block';
                    input.classList.add('border-red-500');
                    valid = false;
                } else {
                    errorElement.style.display = 'none';
                    input.classList.remove('border-red-500');
                }

                if (input.type === 'email') {
                    const emailRegex = /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;
                    if (!emailRegex.test(input.value.trim())) {
                        errorElement.textContent = 'Invalid email address';
                        errorElement.style.display = 'block';
                        input.classList.add('border-red-500');
                        valid = false;
                    }
                }

                if (input.type === 'number' && input.id === 'order-quantity') {
                    if (parseInt(input.value) <= 0) {
                        errorElement.textContent = 'Quantity must be greater than zero.';
                        errorElement.style.display = 'block';
                        input.classList.add('border-red-500');
                        valid = false;
                    }
                }
            });
            return valid;
        }
    </script>
</body>
</html>